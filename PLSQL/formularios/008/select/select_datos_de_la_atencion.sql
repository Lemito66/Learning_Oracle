SELECT
    DECODE(A.TIPO_MOTIVO_ATENCION, 'TRAUMA', 'true', 'false') TRAUMA_X,
    DECODE(
        A.TIPO_MOTIVO_ATENCION,
        'CAUSA CLÍNICA',
        'true',
        'false'
    ) CAUSA_CLINICA_X,
    DECODE(
        A.TIPO_MOTIVO_ATENCION,
        'CAUSA G. OBSTÉTRICA',
        'true',
        'false'
    ) CAUSA_OBSTETRICA_X,
    DECODE(
        A.TIPO_MOTIVO_ATENCION,
        'CAUSA QUIRÚRGICA',
        'true',
        'false'
    ) CAUSA_QUIRURGICA_X,
    A.FECHA_EVENTO,
    A.LUGAR_EVENTO,
    A.DIRECCION_EVENTO,
    DECODE(NVL(A.ALCOCHECK, 'NO'), 'NO', 'false', 'true') ALCOCHECK,
    DECODE(A.VIA_AEREA, 'LIBRE', 'true', 'false') VIA_AREA_LIBRE,
    DECODE(A.VIA_AEREA, 'OBSTRUÍDA', 'true', 'false') VIA_AREA_OBSTRUIDA,
    DECODE(A.CONDICION, 'ESTABLE', 'true', 'false') CONDICION_ESTABLE,
    DECODE(A.CONDICION, 'INESTABLE', 'true', 'false') CONDICION_INESTABLE,
    A.DETALLE_ENFERMEDAD_ACTUAL ENFERMEDAD_ACTUAL,
    -- SIGNOS VITALES
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 4) PRESION_ARTERIAL_1,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 5) PRESION_ARTERIAL_2,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 2) FRECUENCIA_CARDIACA,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 3) FRECUENCIA_RESPIRATORIA,
    FUN_SIGNOS_VITALES_TEMPERATURA (A.CD_ATENDIMENTO, 8) TEMPERATURA_BUCAL,
    FUN_SIGNOS_VITALES_TEMPERATURA (A.CD_ATENDIMENTO, 7) TEMPERATURA_AXILAR,
    FUN_SIGNOS_VITALES_U (A.CD_ATENDIMENTO, 8) PESO,
    FUN_SIGNOS_VITALES_U (A.CD_ATENDIMENTO, 9) TALLA,
    FUN_SIGNOS_VITALES_IMC (A.CD_ATENDIMENTO) IMC,
    FUN_SIGNOS_VITALES_GLASGOW (A.CD_ATENDIMENTO, 'OCULAR') OCULAR,
    FUN_SIGNOS_VITALES_GLASGOW (A.CD_ATENDIMENTO, 'VERBAL') VERBAL,
    FUN_SIGNOS_VITALES_GLASGOW (A.CD_ATENDIMENTO, 'MOTORA') MOTORA,
    FUN_SIGNOS_VITALES_GLASGOW_T_U (A.CD_ATENDIMENTO) TOTAL_GLASGOW,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 42) REACCION_DERECHA,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 43) REACCION_IZQUIERDA,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 41) LLENADO_CAPILAR,
    FUN_SIGNOS_VITALES (A.CD_ATENDIMENTO, 7) SATURACION_OXIGENO,
    -- HERIDAS
    DECODE(A.LOCALIZACION_1, 0, NULL, A.LOCALIZACION_1) LOCALIZACION_1,
    DECODE(A.LOCALIZACION_2, 0, NULL, A.LOCALIZACION_2) LOCALIZACION_2,
    DECODE(A.LOCALIZACION_3, 0, NULL, A.LOCALIZACION_3) LOCALIZACION_3,
    DECODE(A.LOCALIZACION_4, 0, NULL, A.LOCALIZACION_4) LOCALIZACION_4,
    DECODE(A.LOCALIZACION_5, 0, NULL, A.LOCALIZACION_5) LOCALIZACION_5,
    DECODE(A.LOCALIZACION_6, 0, NULL, A.LOCALIZACION_6) LOCALIZACION_6,
    DECODE(A.LOCALIZACION_7, 0, NULL, A.LOCALIZACION_7) LOCALIZACION_7,
    DECODE(A.LOCALIZACION_8, 0, NULL, A.LOCALIZACION_8) LOCALIZACION_8,
    DECODE(A.LOCALIZACION_9, 0, NULL, A.LOCALIZACION_9) LOCALIZACION_9,
    DECODE(A.LOCALIZACION_10, 0, NULL, A.LOCALIZACION_10) LOCALIZACION_10,
    DECODE(A.LOCALIZACION_11, 0, NULL, A.LOCALIZACION_11) LOCALIZACION_11,
    DECODE(A.LOCALIZACION_12, 0, NULL, A.LOCALIZACION_12) LOCALIZACION_12,
    DECODE(A.LOCALIZACION_13, 0, NULL, A.LOCALIZACION_13) LOCALIZACION_13,
    DECODE(A.LOCALIZACION_14, 0, NULL, A.LOCALIZACION_14) LOCALIZACION_14,
    DECODE(A.LOCALIZACION_15, 0, NULL, A.LOCALIZACION_15) LOCALIZACION_15,
    A.LOCALIZACION_OTRO,
    -- DATOS GINECOLOGICOS
    A.GESTAS,
    A.PARTOS,
    A.ABORTOS,
    A.CESAREAS,
    A.FUM,
    A.SEMANAS_GESTACION,
    A.MOVIMIENTO,
    A.FRECUENCIA_FETAL,
    A.MEMBRANAS_ROTAS,
    A.TIEMPO,
    A.ALTURA_UTERINA,
    A.PRESENTACION,
    A.DILATACION,
    A.BORRAMIENTO,
    A.PLANO,
    A.PELVIS_UTIL,
    A.SANGRADO_VAGINAL,
    A.CONTRACCIONES,
    A.MONITOREO_GINECOLOGICO,
    -- OTROS EXAMENES
    OBSERVACIONES_OTRO_EXAMEN,
    DECODE(
        TRIM(A.CONSENTIMIENTO_VERBAL),
        'SI',
        'true',
        'false'
    ) CONSENTIMIENTO_VERBAL,
    -- DIAGNOSTICOS
    FUN_DIAGNOSTICOS_INGRESO_008 (A.CD_ATENDIMENTO) DIAGNOSTICO_INGRESO,
    FUN_DIAGNOSTICOS_EGRESO_008 (A.CD_ATENDIMENTO) DIAGNOSTICO_EGRESO,
    -- PLANES DE EGRESO
    'INDICACIONES' || CHR(10) || '---------------------' || CHR(10) || PLANES_TRATAMIENTO PLAN_TRATAMIENTO_1,
    FUN_DETALLE_MEDICACION_008 (A.CD_ATENDIMENTO) PLAN_TRATAMIENTO_2,
    -- FINAL USUARIO
    U.NM_USUARIO USUARIO_CREA,
    U.CD_IDENTIFICADOR_PESSOA CODIGO_CREA,
    A.FUENTE_INFORMACION, -- Es el campo 45
    A.TELEFONO_FUENTE 
    /* INTO V_CAMPO43,
    V_CAMPO44,
    V_CAMPO45,
    V_CAMPO46,
    V_CAMPO50,
    V_CAMPO51,
    V_CAMPO52,
    V_CAMPO79,
    V_CAMPO90,
    V_CAMPO91,
    V_CAMPO92,
    V_CAMPO93,
    V_CAMPO94,
    V_CAMPO95,
    V_CAMPO96,
    V_CAMPO97,
    V_CAMPO98,
    V_CAMPO99,
    V_CAMPO100,
    V_CAMPO101,
    V_CAMPO102,
    V_CAMPO103,
    V_CAMPO104,
    V_CAMPO105,
    V_CAMPO106,
    V_CAMPO107,
    V_CAMPO108,
    V_CAMPO109,
    V_CAMPO110,
    V_CAMPO111,
    V_CAMPO122,
    V_CAMPO123,
    V_CAMPO124,
    V_CAMPO125,
    V_CAMPO126,
    V_CAMPO127,
    V_CAMPO128,
    V_CAMPO129,
    V_CAMPO130,
    V_CAMPO131,
    V_CAMPO132,
    V_CAMPO133,
    V_CAMPO134,
    V_CAMPO135,
    V_CAMPO136,
    V_CAMPO137,
    V_CAMPO138,
    V_CAMPO139,
    V_CAMPO140,
    V_CAMPO141,
    V_CAMPO142,
    V_CAMPO143,
    V_CAMPO144,
    V_CAMPO145,
    V_CAMPO146,
    V_CAMPO147,
    V_CAMPO148,
    V_CAMPO149,
    V_CAMPO150,
    V_CAMPO151,
    V_CAMPO152,
    V_CAMPO153,
    V_CAMPO154,
    V_CAMPO155,
    V_CAMPO156,
    V_CAMPO173,
    V_CAMPO174,
    V_CAMPO176,
    V_CAMPO177,
    V_CAMPO178,
    V_CAMPO179,
    V_CAMPO180,
    V_CAMPO181,
    V_CAMPO39,
    V_CAMPO41 */
FROM
    T_EMERGENCIA A,
    USUARIOS U
WHERE
    A.CD_ATENDIMENTO = VATENDIMENTO
    AND TRIM(A.USUARIO) = U.CD_USUARIO
    AND A.CD_ULTIMO_REGISTRO IN (
        SELECT
            MAX(B.CD_ULTIMO_REGISTRO)
        FROM
            T_EMERGENCIA B
        WHERE
            B.CD_ATENDIMENTO = VATENDIMENTO
    );